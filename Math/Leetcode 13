// Problem: Roman to Integer
// Platform: LeetCode / CodeChef / GitHub
//
// -------------------------------------------------
// Approaches:
// 1. Map + Look Ahead (Most Common)
// 2. Scan from Right to Left (Clean & Preferred)
// 3. Hardcoded Subtraction Cases
// -------------------------------------------------
//
// Time Complexity: O(n)
// Space Complexity: O(1)
// -------------------------------------------------

#include <bits/stdc++.h>
using namespace std;

class Solution {
public:
    /*-------------------------------------------------
      APPROACH 1: Map + Look Ahead
    -------------------------------------------------*/
    int romanToInt_LookAhead(string s) {
        unordered_map<char, int> mp = {
            {'I', 1}, {'V', 5}, {'X', 10},
            {'L', 50}, {'C', 100}, {'D', 500}, {'M', 1000}
        };

        int ans = 0;
        for (int i = 0; i < s.size(); i++) {
            if (i + 1 < s.size() && mp[s[i]] < mp[s[i + 1]]) {
                ans -= mp[s[i]];
            } else {
                ans += mp[s[i]];
            }
        }
        return ans;
    }

    /*-------------------------------------------------
      APPROACH 2: Scan from Right to Left (BEST)
    -------------------------------------------------*/
    int romanToInt_RightToLeft(string s) {
        unordered_map<char, int> mp = {
            {'I', 1}, {'V', 5}, {'X', 10},
            {'L', 50}, {'C', 100}, {'D', 500}, {'M', 1000}
        };

        int ans = 0, prev = 0;
        for (int i = s.size() - 1; i >= 0; i--) {
            int curr = mp[s[i]];
            if (curr < prev)
                ans -= curr;
            else
                ans += curr;
            prev = curr;
        }
        return ans;
    }

    /*-------------------------------------------------
      APPROACH 3: Hardcoded Subtraction Cases
    -------------------------------------------------*/
    int romanToInt_Hardcoded(string s) {
        unordered_map<char, int> mp = {
            {'I', 1}, {'V', 5}, {'X', 10},
            {'L', 50}, {'C', 100}, {'D', 500}, {'M', 1000}
        };

        int ans = 0;
        for (int i = 0; i < s.size(); i++) {
            if (s[i] == 'I' && i + 1 < s.size() && (s[i + 1] == 'V' || s[i + 1] == 'X'))
                ans -= 1;
            else if (s[i] == 'X' && i + 1 < s.size() && (s[i + 1] == 'L' || s[i + 1] == 'C'))
                ans -= 10;
            else if (s[i] == 'C' && i + 1 < s.size() && (s[i + 1] == 'D' || s[i + 1] == 'M'))
                ans -= 100;
            else
                ans += mp[s[i]];
        }
        return ans;
    }

    /*-------------------------------------------------
      MAIN FUNCTION USED BY LEETCODE
    -------------------------------------------------*/
    int romanToInt(string s) {
        return romanToInt_RightToLeft(s); // recommended
    }
};

int main() {
    Solution obj;

    string s1 = "III";
    string s2 = "LVIII";
    string s3 = "MCMXCIV";

    cout << "III -> " << obj.romanToInt(s1) << endl;       // 3
    cout << "LVIII -> " << obj.romanToInt(s2) << endl;     // 58
    cout << "MCMXCIV -> " << obj.romanToInt(s3) << endl;   // 1994

    return 0;
}
